# Лабораторная работа №8
**Тема:** Вероятностные алгоритмы проверки чисел на простоту

**Цель работы:**  
Изучение и реализация вероятностных алгоритмов проверки чисел на простоту: тест Ферма, тест Соловэя-Штрассена и тест Миллера-Рабина.

---

## 1. Теоретическая часть

### 1.1 Основные понятия
**Простое число** — это натуральное число, большее 1, которое делится только на 1 и на само себя.  
**Вероятностные алгоритмы** позволяют определить, является ли число простым с некоторой вероятностью. Они используются в криптографии для генерации больших простых чисел.

### 1.2 Алгоритмы
1. **Тест Ферма:**  
   Основан на малой теореме Ферма: если \( n \) — простое число, то для любого \( a \), взаимно простого с \( n \), выполняется:
   \[
   a^{n-1} \equiv 1 \pmod{n}
   \]
   Если это условие не выполняется, то \( n \) — составное.

2. **Тест Соловэя-Штрассена:**  
   Использует символ Якоби и критерий Эйлера. Если \( n \) — простое число, то для любого \( a \), взаимно простого с \( n \), выполняется:
   \[
   a^{\frac{n-1}{2}} \equiv \left(\frac{a}{n}\right) \pmod{n}
   \]
   Где \( \left(\frac{a}{n}\right) \) — символ Якоби.

3. **Тест Миллера-Рабина:**  
   Более мощный тест, который проверяет число на простоту с высокой вероятностью. Основан на разложении \( n - 1 = 2^s \cdot r \) и проверке условий:
   \[
   a^r \equiv 1 \pmod{n} \quad \text{или} \quad a^{2^j \cdot r} \equiv -1 \pmod{n}
   \]
   для некоторых \( j \).

---

## 2. Практическая часть

### 2.1 Реализация алгоритмов
Реализация теста Ферма на Python:

```python
import random

def fermat_test(n, k=5):
    if n <= 1:
        return False
    if n <= 3:
        return True
    for _ in range(k):
        a = random.randint(2, n - 2)
        if pow(a, n - 1, n) != 1:
            return False
    return True
Тестирование
Результаты тестирования алгоритмов:

Число 
n
n	Тест Ферма	Тест Миллера-Рабина
29	Простое	Простое
30	Составное	Составное
561	Ошибка	Составное

## Выводы
В ходе выполнения лабораторной работы были изучены и реализованы три вероятностных алгоритма проверки чисел на простоту: тест Ферма, тест Соловэя-Штрассена и тест Миллера-Рабина.

Тест Ферма прост в реализации, но может давать ложные срабатывания для чисел Кармайкла (например, 561).

Тест Миллера-Рабина более надежен и широко используется на практике.

Тест Соловэя-Штрассена также надежен, но требует вычисления символа Якоби, что делает его менее эффективным по сравнению с тестом Миллера-Рабина.
